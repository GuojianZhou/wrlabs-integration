Feature Notes
=============

The user key in a general sense is able to be used in the product with
contrary of the sample key. This template (feature/user-key-store-test)
wraps the instructions of user keys generation for the convenience.

If the user doesn't use the keys generated by self, this template can
help to generate the user keys, and export them to
$project/tmp/deploy/images/intel-corei7-64/user-keys/.

If the user switchs to create the user keys by self, please consider to
construct a template or layer for the user key store. Refer to
this tempalte (feature/user-key-store-test/template.conf) as an example
to get the required definitions in order to enable the user key store.
The vital definitions include:

- USE_USER_KEY = "1"
  Prohibit using the sample keys for signing the images.

- UEFI_KEYS_DIR := "<path>"
  Point to the location of user keys used for UEFI Secure Boot. If not defined,
  the user keys for UEFI Secure Boot will be generated.

- MOK_KEYS_DIR := "<path>"
  Point to the location of user keys used for Mok Secure Boot. Note that
  Mok Secure Boot is on top of UEFI Secure Boot so creating the user keys
  for Mok Secure Boot only will still introduce the security risk in your
  product. If not defined, the user keys for Mok Secure Boot will be
  generated.

- USER_KEY_SHOW_VERBOSE = "1"
  Optional. Used to enable the verbose output for debug purpose.

To ensure a image signed by the sample key cannot be loaded by a image
signed by the user key, e.g, preventing the shim signed by the user key from
loading the grub signed by the sample key, certain sample keys are added
to the blacklists during the build, meaning the following precautions:

- Blacklist the sample DB and DBX in DBX database for UEFI Secure Boot.
- Blacklist the sample DB, shim_cert and vendor_cert in vendor_dbx database
  for Mok Secure Boot.
- Cascade the default blacklist mentioned above and the user specified
  blacklist if any.

For the details about UEFI Secure Boot and Mok Secure Boot, please refer
to feature/uefi-secure-boot/README and feature/mok-secure-boot/README
correspondingly.
